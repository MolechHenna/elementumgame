<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <meta name="description" content="">
        <meta name="author" content="">
<meta name="google-adsense-account" content="ca-pub-7801318214806091">
        <title>Elementum/Downloads</title>

        <!-- CSS FILES -->        
        <link rel="preconnect" href="https://fonts.googleapis.com">
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

        <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@500;600;700&family=Open+Sans&display=swap" rel="stylesheet">
                        
        <link href="css/bootstrap.min.css" rel="stylesheet">

        <link href="css/bootstrap-icons.css" rel="stylesheet">

        <link href="css/templatemo-topic-listing.css" rel="stylesheet">    

        <link rel="icon" href="images/Elementum-logo.png">

        <!--FONT GOOGLE -->
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700&display=swap" rel="stylesheet">
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Lato:wght@700&family=Lilita+One&display=swap" rel="stylesheet">
    <link href="css/templatemo-topic-listing1.css" rel="stylesheet">
    <link rel="stylesheet" href="neostyle.css">
</head>

<body id="top">
		<style>
    .topics-detail-block-image-2, .topics-detail-block-image{
                                width: 300px;
                                margin: auto;
                            }
    @media (max-width: 700px) {
                            blockquote {
                                font-size: 14px; /* Adjust the font size for smaller screens */
                                margin: 15px; /* Adjust the margin for smaller screens */
                                padding: 20px; /* Adjust the padding for smaller screens */
                            }
                            .custom-block-image {
                                width: 50%;
                                height: 50%;
                                margin-top: 10px;
                                margin: auto;
                            }
                            p{
                                font-size: 15px;
                                line-height: 1.4;
                                text-align: justify;
                                font-weight: normal;
                            }
                            
                            .text-white{
                                font-weight: normal;
                                line-height: normal;

                            }
                            
                            .site-header{
                                padding-bottom: 20px;
                            }
                            
                            .list-progress, .icon-holder, .icon-holder::before, .icon-holder i{
                                position: relative;
                                height: 0%;
                                width: 0%;
                                z-index: -5;
                                background-color: rgba(255,0,0,0);
                                opacity: 0;
                                display: none;
                                padding: 0;
                            }
                            
                            .timeline-container .vertical-scrollable-timeline li {
                              padding: 0px;
                            }
                            
                            a.small-link:link {
                                font-size: 15px;
                            }
                            
                            .image-inside{
                                height: 30%;
                            }
                            
                            .topics-detail-block-image-2, .topics-detail-block-image{
                                width: 200px;
                                margin: auto;
                            }
    }
</style>
    <div id="preloader">
            <div class="wrapper">
        <div class="box-wrap">
            <div class="box one"></div>
            <div class="box two"></div>
            <div class="box three"></div>
            <div class="box four"></div>
            <div class="box five"></div>
            <div class="box six"></div>
        </div>
    </div>
    </div>
        <main>

            <nav class="navbar navbar-expand-lg">
                <div class="container">
                    <a class="navbar-brand" href="index.html">
                        <img src="images/Full-logo.png" alt="Topic Image" style="max-width: 200px; max-height: 90px; filter: drop-shadow(1px 2px 1px black)">
                    </a>
    
                    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                        <span class="navbar-toggler-icon"></span>
                    </button>
    
                    <div class="collapse navbar-collapse" id="navbarNav">
                        <ul class="navbar-nav ms-lg-5 me-lg-auto">
                            <li class="nav-item">
                                <a class="nav-link click-scroll" href="index.html">HOME</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link click-scroll" href="#topics-detail">DOWNLOAD SECTION</a>
                            </li>
                            <li class="nav-item dropdown">
                                <a class="nav-link dropdown-toggle" href="#section_5" id="navbarLightDropdownMenuLink" role="button" data-bs-toggle="dropdown" aria-expanded="false">PROFILE</a>
    
                                <ul class="dropdown-menu dropdown-menu-light" aria-labelledby="navbarLightDropdownMenuLink">
                                    <li id="profilelog" style="display: none"><a class="dropdown-item" href="index_profile.html">Account</a></li>
                            
                                    <li id="loginItem" style="display: none"><a class="dropdown-item" href="register_UI/index.html">Log-in</a></li>
                                    
                                </ul>
                            </li>
                        </ul>
                    </div>
                </div>
            </nav>
            

            <header class="site-header d-flex flex-column justify-content-center align-items-center hero-section d-flex justify-content-center align-items-center">
                <div class="container">
                    <div class="row justify-content-center align-items-center">

                        <div class="col-lg-5 col-12 mb-5">
                            <nav aria-label="breadcrumb">
                                <ol class="breadcrumb">
                                    <li class="breadcrumb-item"><a href="index.html">Homepage</a></li>

                                    <li class="breadcrumb-item active" aria-current="page">Downloads</li>
                                </ol>
                            </nav>

                            <h2 class="text-white" style="  text-shadow:
                                                                        -4px -4px 0 #000,
                                                                         0   -4px 0 #000,
                                                                         4px -4px 0 #000,
                                                                         4px  0   0 #000,
                                                                         4px  4px 0 #000,
                                                                         0    4px 0 #000,
                                                                        -4px  4px 0 #000,
                                                                        -4px  0   0 #000;">Downloads</h2>
                        </div>

                        <div class="col-lg-5 col-12">
                            <div class="topics-detail-block-2">
                                <img src="images/downloadphoto.png" class="topics-detail-block-image-2  img-fluid">
                            </div>
                        </div>

                    </div>
                </div>
            </header>


            <!-- Your HTML structure -->
<section class="topics-detail-section section-padding" id="topics-detail">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-12 m-auto">
                <h3 class="mb-4">Versions</h3>
                <div id="versionsContainer"></div>
            </div>
        </div>
    </div>
</section>
<style>
    /* Custom styles */
.custom-version-div {
    border: 2px solid #ccc;
    padding: 15px;
    margin-bottom: 15px;
    border-radius: 15px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); /* Adding a box shadow */
}

.custom-version-title {
    font-size: 20px;
    color: #333;
}

.custom-version-date {
    font-size: 14px;
    color: #666;
}

.custom-download-button {
    background-color: #28a745;
    color: #fff;
    border: 2px solid #fff;
    border-radius: 5px;
}

.custom-download-button:hover {
    background-color: #218838;
        border-radius: 5px;

}

.custom-patchnote {
    font-size: 16px;
    color: #444;
}
.latest-text{
        font-size: 20px;
        color: #28a745;
        font-family: 'lilita one', cursive;

}
.not-latest{
    font-size: 12px;
        color: red;
        font-family: 'lilita one', cursive;
}


    .latest-version {
        background-color: #e6f7ff; /* Change the background color as needed */
        padding: 20px 20px 20px 15px; /* Add padding to make it visually distinct */
        border-width:15px 15px 30px 15px;
        border-style: solid;
        border-color:#28a745;
        border-bottom: 30px solid #28a745; /* Add a solid border with the specified color */
        text-align: center; /* Center the content within the element */
        margin-bottom: 50px;
                        box-shadow: 0 10px 24px rgba(0, 0, 0, 0.1); /* Adding a box shadow */

    }

    .latest-version .download-button {
        padding: 15px 30px; /* Increase button padding for better visibility */
        font-size: 30px; /* Increase button font size for better visibility */
        border-radius: 20px;
        font-family: 'lilita one', cursive;
            border-radius: 15px;


    }
    
    .latest-version .custom-version-title {
        font-size: 50px;
        color: #333;

    }
    
      .latest-version .custom-version-date {
        font-size: 40px;
        color: #666;

    }
    .latest-version .latest-text {
        font-size: 30px;
        color: #28a745;
        font-family: 'lilita one', cursive;

    }
</style>

        </main>

        <footer class="site-footer section-padding">
            <div class="container">
                <div class="row">

                    <div class="col-lg-3 col-12 mb-4 pb-2">
                        <a class="navbar-brand mb-2" href="index.html">
                            <img src="images/Full-logo.png" alt="Topic Image" style="max-width: 210px; max-height: 100px; filter: drop-shadow(1px 2px 1px black)">
                        </a>
                    </div>

                    <div class="col-lg-3 col-md-4 col-12 mt-4 mt-lg-0 ms-auto">

                        <p class="copyright-text mt-lg-5 mt-4">Copyright © 2024 Elementum
                        <br><br></p>
                        
                    </div>

                </div>
            </div>
        </footer>

        <!-- JAVASCRIPT FILES -->
        <script type="module" src="js/signout1.js"></script>
        <script type="module" src="js/firebase-observer.js"></script>
        <script src="js/jquery.min.js"></script>
        <script src="js/bootstrap.bundle.min.js"></script>
        <script src="js/jquery.sticky.js"></script>
        <script src="js/custom.js"></script>
        <script type="module">
    import { firebaseConfig } from "/js/firebase-config.js";
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.5.2/firebase-app.js";
    import {
        getDatabase,
        ref,
        onValue
    } from "https://www.gstatic.com/firebasejs/10.5.2/firebase-database.js";
    import { getStorage, ref as storageRef, getDownloadURL } from "https://www.gstatic.com/firebasejs/10.5.2/firebase-storage.js";

   const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);
    const apkDownloadRef = ref(db, "apkDownload");

    // Function to fetch versions data from Firebase and populate the HTML
    function populateVersions() {
        const versionsContainer = document.getElementById("versionsContainer");

        // Fetch data from Firebase
        onValue(apkDownloadRef, (snapshot) => {
            const versionsData = snapshot.val();

            if (versionsData) {
                versionsContainer.innerHTML = ""; // Clear existing content

                // Get the keys and sort them based on the date in descending order
                const sortedKeys = Object.keys(versionsData).sort((a, b) => {
                    const dateA = new Date(versionsData[a].date);
                    const dateB = new Date(versionsData[b].date);
                    return dateB - dateA;
                });

                sortedKeys.forEach((uid, index) => {
                    const versionDetails = versionsData[uid];

                    // Create HTML elements dynamically with custom styles
                    const versionDiv = document.createElement("div");
                    versionDiv.classList.add("custom-version-div"); // Custom CSS class

                    // Additional styling for the latest version
                    if (index === 0) {
                        versionDiv.classList.add("latest-version");
                    }

                    versionDiv.innerHTML = `
                        <div class="mb-2">
                            <h5 class="font-weight-bold custom-version-title">
                                ${versionDetails.version} 
                                <span class="text-muted custom-version-date">
                                    ${versionDetails.date}
                                </span>
                            </h5>
                            ${index === 0 ? '<span class="latest-text">(Latest version)</span>' : '<span class="latest-text">(Previous version)</span>'}
                        </div>
                        ${index === 0 ? '' : '<span class="not-latest">While you can download the previous version and still play it, it may not work as intended.</span>'}
                        <div>
                            <button class="btn btn-success border-white download-button custom-download-button" data-uid="${uid}">Download</button>
                            <div class="mt-2 custom-patchnote">${versionDetails.patchnote}</div>
                        </div>
                    `;

                    // Append the created elements to the container
                    versionsContainer.appendChild(versionDiv);

                    // Attach click event using addEventListener
                    const downloadButton = versionDiv.querySelector(".download-button");
                    downloadButton.addEventListener("click", () => {
                        downloadFile(uid);
                    });
                });
            } else {
                console.log('No versions data found');
            }
        });
    }

    // Call populateVersions when the DOM is fully loaded
    document.addEventListener('DOMContentLoaded', () => {
        populateVersions();
    });

    // Function to download a file by its filename
    function downloadFile(uid) {
        // Reference to the "apkDownload" node in the database
        const apkDownloadRef = ref(db, `apkDownload/${uid}`);

        // Fetch data from Firebase to get the filename
        onValue(apkDownloadRef, (snapshot) => {
            const versionDetails = snapshot.val();

            if (versionDetails && versionDetails.filename) {
                // Assuming the filename is stored in the "filename" field
                const filename = versionDetails.filename;

                // Reference to the file in Firebase Storage
                const fileRef = storageRef(getStorage(), `apkversion/${filename}`);

                // Get the download URL for the file
                getDownloadURL(fileRef)
                    .then((url) => {
                        // Create a temporary link element to trigger the download
                        const a = document.createElement("a");
                        a.href = url;
                        a.download = filename;
                        a.target = "_blank"; // Open in a new tab
                        a.style.display = "none";

                        // Add the link to the document and trigger the click event
                        document.body.appendChild(a);
                        a.click();

                        // Clean up by removing the link element
                        document.body.removeChild(a);
                    })
                    .catch((error) => {
                        console.error("Error getting download URL:", error);
                    });
            } else {
                console.log('Version details or filename not found');
            }
        });
    }
</script>
        <script>
            var loader = document.getElementById("preloader");

            window.addEventListener("load", function(){
                loader.style.display = "none";
            })

        </script>
    </body>
</html>